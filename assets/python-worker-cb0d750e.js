(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const x=Symbol("Comlink.proxy"),O=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),_=Symbol("Comlink.finalizer"),m=Symbol("Comlink.thrown"),S=e=>typeof e=="object"&&e!==null||typeof e=="function",z={canHandle:e=>S(e)&&e[x],serialize(e){const{port1:n,port2:r}=new MessageChannel;return P(e,n),[r,[r]]},deserialize(e){return e.start(),j(e)}},I={canHandle:e=>S(e)&&m in e,serialize({value:e}){let n;return e instanceof Error?n={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:n={isError:!1,value:e},[n,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},v=new Map([["proxy",z],["throw",I]]);function N(e,n){for(const r of e)if(n===r||r==="*"||r instanceof RegExp&&r.test(n))return!0;return!1}function P(e,n=globalThis,r=["*"]){n.addEventListener("message",function c(s){if(!s||!s.data)return;if(!N(r,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:i,type:a,path:u}=Object.assign({path:[]},s.data),l=(s.data.argumentList||[]).map(y);let t;try{const o=u.slice(0,-1).reduce((d,g)=>d[g],e),f=u.reduce((d,g)=>d[g],e);switch(a){case"GET":t=f;break;case"SET":o[u.slice(-1)[0]]=y(s.data.value),t=!0;break;case"APPLY":t=f.apply(o,l);break;case"CONSTRUCT":{const d=new f(...l);t=G(d)}break;case"ENDPOINT":{const{port1:d,port2:g}=new MessageChannel;P(e,g),t=W(d,[d])}break;case"RELEASE":t=void 0;break;default:return}}catch(o){t={value:o,[m]:0}}Promise.resolve(t).catch(o=>({value:o,[m]:0})).then(o=>{const[f,d]=E(o);n.postMessage(Object.assign(Object.assign({},f),{id:i}),d),a==="RELEASE"&&(n.removeEventListener("message",c),A(n),_ in e&&typeof e[_]=="function"&&e[_]())}).catch(o=>{const[f,d]=E({value:new TypeError("Unserializable return value"),[m]:0});n.postMessage(Object.assign(Object.assign({},f),{id:i}),d)})}),n.start&&n.start()}function H(e){return e.constructor.name==="MessagePort"}function A(e){H(e)&&e.close()}function j(e,n){return k(e,[],n)}function h(e){if(e)throw new Error("Proxy has been released and is not useable")}function M(e){return p(e,{type:"RELEASE"}).then(()=>{A(e)})}const w=new WeakMap,b="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const n=(w.get(e)||0)-1;w.set(e,n),n===0&&M(e)});function U(e,n){const r=(w.get(n)||0)+1;w.set(n,r),b&&b.register(e,n,e)}function V(e){b&&b.unregister(e)}function k(e,n=[],r=function(){}){let c=!1;const s=new Proxy(r,{get(i,a){if(h(c),a===F)return()=>{V(s),M(e),c=!0};if(a==="then"){if(n.length===0)return{then:()=>s};const u=p(e,{type:"GET",path:n.map(l=>l.toString())}).then(y);return u.then.bind(u)}return k(e,[...n,a])},set(i,a,u){h(c);const[l,t]=E(u);return p(e,{type:"SET",path:[...n,a].map(o=>o.toString()),value:l},t).then(y)},apply(i,a,u){h(c);const l=n[n.length-1];if(l===O)return p(e,{type:"ENDPOINT"}).then(y);if(l==="bind")return k(e,n.slice(0,-1));const[t,o]=T(u);return p(e,{type:"APPLY",path:n.map(f=>f.toString()),argumentList:t},o).then(y)},construct(i,a){h(c);const[u,l]=T(a);return p(e,{type:"CONSTRUCT",path:n.map(t=>t.toString()),argumentList:u},l).then(y)}});return U(s,e),s}function D(e){return Array.prototype.concat.apply([],e)}function T(e){const n=e.map(E);return[n.map(r=>r[0]),D(n.map(r=>r[1]))]}const C=new WeakMap;function W(e,n){return C.set(e,n),e}function G(e){return Object.assign(e,{[x]:!0})}function E(e){for(const[n,r]of v)if(r.canHandle(e)){const[c,s]=r.serialize(e);return[{type:"HANDLER",name:n,value:c},s]}return[{type:"RAW",value:e},C.get(e)||[]]}function y(e){switch(e.type){case"HANDLER":return v.get(e.name).deserialize(e.value);case"RAW":return e.value}}function p(e,n,r){return new Promise(c=>{const s=q();e.addEventListener("message",function i(a){!a.data||!a.data.id||a.data.id!==s||(e.removeEventListener("message",i),c(a.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:s},n),r)})}function q(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var R=function(e,n,r,c){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function u(o){try{t(c.next(o))}catch(f){a(f)}}function l(o){try{t(c.throw(o))}catch(f){a(f)}}function t(o){o.done?i(o.value):s(o.value).then(u,l)}t((c=c.apply(e,n||[])).next())})},L=function(e,n){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},c,s,i,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(t){return function(o){return l([t,o])}}function l(t){if(c)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(r=0)),r;)try{if(c=1,s&&(i=t[0]&2?s.return:t[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,t[1])).done)return i;switch(s=0,i&&(t=[t[0]&2,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return r.label++,{value:t[1],done:!1};case 5:r.label++,s=t[1],t=[0];continue;case 7:t=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(t[0]===6||t[0]===2)){r=0;continue}if(t[0]===3&&(!i||t[1]>i[0]&&t[1]<i[3])){r.label=t[1];break}if(t[0]===6&&r.label<i[1]){r.label=i[1],i=t;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(t);break}i[2]&&r.ops.pop(),r.trys.pop();continue}t=n.call(e,r)}catch(o){t=[6,o],s=0}finally{c=i=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};importScripts("https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"),self.location.hostname!=="localhost"&&(console.log=function(){},console.error=function(){});var X={getInput:function(e,n){var r=new XMLHttpRequest;return r.open("GET","/react-py-get-input/?id=".concat(e,"&prompt=").concat(n),!1),r.send(null),r.responseText}},Y={init:function(e,n,r){return R(this,void 0,void 0,function(){var c,s,i,a,u,l;return L(this,function(t){switch(t.label){case 0:return c=self,[4,self.loadPyodide({stdout:e})];case 1:return c.pyodide=t.sent(),[4,self.pyodide.loadPackage(["pyodide-http"])];case 2:return t.sent(),r[0].length>0?[4,self.pyodide.loadPackage(r[0])]:[3,4];case 3:t.sent(),t.label=4;case 4:return r[1].length>0?[4,self.pyodide.loadPackage(["micropip"])]:[3,7];case 5:return t.sent(),s=self.pyodide.pyimport("micropip"),[4,s.install(r[1])];case 6:t.sent(),t.label=7;case 7:return i=self.crypto.randomUUID(),a=self.pyodide.version,self.pyodide.registerJsModule("react_py",X),u=`
import pyodide_http
pyodide_http.patch_all()
`,[4,self.pyodide.runPythonAsync(u)];case 8:return t.sent(),l=`
import sys, builtins
import react_py
__prompt_str__ = ""
def get_input(prompt=""):
    global __prompt_str__
    __prompt_str__ = prompt
    print(prompt, end="")
    s = react_py.getInput("`.concat(i,`", prompt)
    print(s)
    return s
builtins.input = get_input
sys.stdin.readline = lambda: react_py.getInput("`).concat(i,`", __prompt_str__)
`),[4,self.pyodide.runPythonAsync(l)];case 9:return t.sent(),n({id:i,version:a}),[2]}})})},run:function(e){return R(this,void 0,void 0,function(){return L(this,function(n){switch(n.label){case 0:return[4,self.pyodide.runPythonAsync(e)];case 1:return n.sent(),[2]}})})},readFile:function(e){return self.pyodide.FS.readFile(e,{encoding:"utf8"})},writeFile:function(e,n){return self.pyodide.FS.writeFile(e,n,{encoding:"utf8"})},mkdir:function(e){self.pyodide.FS.mkdir(e)},rmdir:function(e){self.pyodide.FS.rmdir(e)}};P(Y)})();
